<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>AdHabits — Affiliate Opportunities (100% Commission)</title>

<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&family=Poppins:wght@700;800&display=swap" rel="stylesheet">

<style>
:root{
  --bg:#0a0f1b; --text:#e7eaf0; --muted:#9fb0c9; --stroke:#1e2a42;
  --grad:linear-gradient(135deg,#8b5cf6,#22d3ee 55%,#34d399);
  --accent:#ffb454; --accent2:#ff914d;
  --card:#0f172a;
  --answer-black: #06101d;
  --question-color: #0b1220;
}
*{box-sizing:border-box;margin:0;padding:0}
html,body{background:var(--bg);color:var(--text);font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Arial;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}
a{color:inherit;text-decoration:none}
.container{max-width:1150px;margin:auto;padding:0 18px}

/* NAV */
.nav{position:sticky;top:0;z-index:60;background:rgba(10,15,27,.88);backdrop-filter:saturate(160%) blur(8px);border-bottom:1px solid var(--stroke)}
.nav-inner{height:64px;display:flex;align-items:center;justify-content:space-between}
.brand{display:flex;align-items:center;gap:10px;font-weight:800}
.logo{width:28px;height:28px}
.logo img{width:100%;height:100%;object-fit:contain}
.nav-links{display:flex;align-items:center;gap:18px}
.nav-links a{color:#c9d3e6;font-weight:700;font-size:15px}
.hamb{display:none;cursor:pointer;border:1px solid #2b3652;border-radius:10px;padding:8px 10px}
.hamb span{display:block;width:22px;height:2px;background:#c9d3e6;margin:4px 0;border-radius:2px}
@media (max-width:860px){
  .nav-links{display:none}
  .hamb{display:block}
}

/* floating banner (shorter / compact) */
.floating-bar{
  position:fixed;left:50%;transform:translateX(-50%);top:16px;z-index:90;
  background:linear-gradient(90deg,#ff6aa2,#9b5cff);color:#fff;padding:8px 14px;border-radius:999px;font-weight:800;box-shadow:0 14px 40px rgba(155,59,255,.12);
  display:inline-flex;gap:10px;align-items:center;cursor:pointer;animation:floaty 2.8s ease-in-out infinite;
  border:2px solid rgba(255,255,255,.06);
  font-size:13px;
  max-width:360px;
  white-space:nowrap;overflow:hidden;text-overflow:ellipsis;
}
@keyframes floaty{0%{transform:translateX(-50%) translateY(0)}50%{transform:translateX(-50%) translateY(6px)}100%{transform:translateX(-50%) translateY(0)}}

/* HERO */
.hero{
  padding:70px 0 30px;
  background:
   radial-gradient(1200px 600px at 80% -10%, rgba(167,139,250,.20), transparent 60%),
   radial-gradient(900px 500px at -10% 10%, rgba(34,211,238,.10), transparent 60%);
}
.eyebrow{display:inline-block;padding:7px 12px;border:1px solid #2a344f;border-radius:999px;color:#b5c1d8;margin-bottom:12px;font-size:14px}
h1{font-family:Poppins,system-ui,Arial;font-weight:800;font-size:clamp(26px,6vw,48px);line-height:1.02;letter-spacing:-.02em;margin-bottom:10px;color:var(--text)}
.headline-animated{display:inline-block;white-space:normal;overflow:visible}
.hl2{color:var(--accent2)}

/* layout */
.video-area{display:grid;grid-template-columns:1fr 420px;gap:26px;align-items:start;margin-top:18px;align-items:start}
@media (max-width:980px){.video-area{grid-template-columns:1fr;gap:18px;justify-items:center}}
.player-wrap{border-radius:16px;overflow:hidden;border:1px solid #25304a;background:#0b0f1a;box-shadow: 0 30px 60px rgba(0,0,0,0.5)}
.player-frame{position:relative;padding-top:56.25%;background:#111;overflow:hidden}
.player-frame iframe{position:absolute;inset:0;width:100%;height:100%;border:0}
.player-card{background:#fff;color:#0b1220;padding:14px;border-radius:0 0 12px 12px}
.player-shadow{box-shadow:0 40px 80px rgba(0,0,0,.45);border-radius:12px}

.kpis{color:#cfd7e9;margin:10px 0 18px;font-size:15px}
.cta{display:flex;gap:12px;flex-wrap:wrap;margin:6px 0 16px}
.btn{padding:12px 18px;border-radius:12px;font-weight:800;transition:transform .18s ease, box-shadow .18s ease;cursor:pointer}
.btn.primary{background:var(--grad);color:#06101d;border:none}
.btn.secondary{background:#0f1526;border:1px solid #303a57;color:#d7def0}

/* features grid */
.features-section{padding:40px 0 60px;background:linear-gradient(180deg, rgba(255,240,247,0.02), transparent)}
.features-grid{display:grid;grid-template-columns:repeat(4,1fr);gap:22px;margin-top:18px;align-items:start;padding-top:8px;overflow:visible}
@media (max-width:1000px){.features-grid{grid-template-columns:repeat(2,1fr)}}
@media (max-width:640px){
  .features-grid{grid-template-columns:1fr;padding-top:12px}
  /* NO default negative margins — initial state shows full cards.
     JS will add sticky + marginBottom negative when section becomes active. */
  .feature-card{
    overflow:visible !important;
    border-radius:12px;
    will-change:transform;
  }
}
.feature-card{background:#fff;border-radius:12px;padding:22px 18px;text-align:center;color:#0b1220;box-shadow:0 12px 30px rgba(0,0,0,0.14);transition:transform .18s ease}
.feature-card .icon{width:70px;height:70px;border-radius:50%;display:grid;place-items:center;margin:0 auto 12px;background:linear-gradient(90deg,#ff6aa2,#9b5cff);color:#fff;font-weight:800}
.feature-card h3{margin:6px 0 8px;font-size:18px}
.feature-card p{color:#6b7889;margin:0}

/* ensure sticky cards content is visible above neighboring card edges */
.features-grid, .feature-card { overflow: visible; }

/* coach */
.coach-section{max-width:1150px;margin:48px auto;padding:0 18px;display:grid;grid-template-columns:1fr;gap:24px;align-items:center;color:var(--text)}
.coach-inner{display:grid;grid-template-columns:1fr;gap:22px;align-items:center}
.coach-photo{width:100%;border-radius:14px;overflow:hidden;box-shadow:0 20px 50px rgba(0,0,0,0.45);background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01))}
.coach-photo img{width:100%;height:100%;display:block;object-fit:cover}
.coach-copy{display:flex;flex-direction:column;gap:12px}
.coach-badge{display:inline-block;padding:8px 12px;border-radius:999px;background:linear-gradient(90deg,#ff6aa2,#9b5cff);color:#fff;font-weight:700;width:max-content}
.coach-head{font-family:Poppins,system-ui,Arial;font-weight:800;font-size:clamp(20px,4.2vw,36px);line-height:1.02;margin:6px 0;color:var(--text)}
.coach-desc{color:var(--muted);max-width:66ch}
.coach-stats{display:flex;flex-direction:column;gap:10px;margin-top:8px}
.stat-pill{background:linear-gradient(180deg,#0f172a,#0b0f1a);border-radius:12px;padding:12px 16px;min-width:160px;display:flex;flex-direction:column;align-items:center;box-shadow:0 12px 30px rgba(0,0,0,.45), inset 0 0 0 1px rgba(255,255,255,0.02);color:var(--text)}
.stat-num{font-weight:900;font-size:20px;color:#ff6aa2}
.stat-label{font-size:13px;color:var(--muted);margin-top:6px;text-align:center}
.coach-cta{margin-top:14px;display:flex;gap:12px;flex-wrap:wrap;align-items:center}

/* steps / form */
.steps{padding:48px 0}
.steps-grid{display:grid;grid-template-columns:1fr 1fr;gap:20px}
@media (max-width:980px){.steps-grid{grid-template-columns:1fr}}
.step-card{background:#fff;border-radius:10px;padding:20px;display:flex;gap:12px;align-items:flex-start;box-shadow:0 10px 28px rgba(0,0,0,.08)}
.step-num{width:56px;height:56px;border-radius:50%;display:grid;place-items:center;font-weight:800;background:linear-gradient(90deg,#ff6aa2,#9b5cff);color:#fff;font-size:20px}
.step-body h4{margin:0;font-size:18px;color:var(--question-color);font-weight:800}
.step-body p{margin:6px 0 0;color:var(--answer-black);line-height:1.4}

/* form */
#getstart{padding:36px 0}
.form-wrap{display:grid;grid-template-columns:1.1fr .9fr;gap:20px;align-items:start}
@media (max-width:980px){.form-wrap{grid-template-columns:1fr}}
.form-card{border:1px solid #273047;background:linear-gradient(180deg,#0f172a,#0b0f1a);border-radius:16px;padding:18px}
label{display:block;margin:10px 0 6px;color:#bfc9de}
select,input{width:100%;background:#0c1426;border:1px solid #2a3552;border-radius:12px;color:#e6ecf7;padding:12px 14px;outline:none}
select:focus,input:focus{border-color:#3a8bd8}
.form-note{margin:8px 0 2px;color:#9fb0c9}
.form-btn{margin-top:12px;display:inline-flex;align-items:center;gap:8px;padding:12px 18px;border-radius:12px;background:#25d366;color:#061016;font-weight:800;border:none;cursor:pointer}
.form-hint{color:#93a4c6;margin-left:8px}
.right-box{border:1px solid #273047;background:#0f172a;border-radius:16px;padding:18px}

/* small-screen adjustments */
@media (max-width:520px){
  .hero{padding:36px 0}
  h1{font-size:24px;line-height:1.06}
  .player-frame{padding-top:56.25%;max-height:420px}
  .floating-bar{left:50%;right:auto;transform:translateX(-50%);width:auto;max-width:360px;font-size:13px;top:12px;padding:8px 12px}
  .features-grid{padding-bottom:140px}
}

/* reveal animation */
.reveal{opacity:0;transform:translateY(12px);transition:opacity .6s ease, transform .6s ease}
.reveal.on{opacity:1;transform:none}

/* small helpers for feature stacking visuals */
.feature-card.pop{transform:translateY(-6px);box-shadow:0 30px 60px rgba(0,0,0,0.25)}
</style>

</head>
<body>

<header class="nav">
  <div class="container nav-inner">
    <div class="brand">
      <span class="logo"><img src="https://i.postimg.cc/3rVMTKYG/adhabits-logo.png" alt="AdHabits" /></span>
      <span>AdHabits</span>
    </div>
    <nav class="nav-links">
      <a href="#features">What you'll learn</a>
      <a href="#coach">Your Coach</a>
      <a href="#testimonials">Testimonials</a>
      <a href="#getstart" class="btn secondary">WhatsApp</a>
    </nav>
    <div class="hamb" id="hamb"><span></span><span></span><span></span></div>
  </div>
  <div class="mobile-menu" id="mnav" style="display:none">
    <a href="#features">What you'll learn</a>
    <a href="#coach">Your Coach</a>
    <a href="#testimonials">Testimonials</a>
    <a href="#getstart">WhatsApp</a>
  </div>
</header>

<div class="floating-bar" id="floatBanner">▶ Watch this video first</div>

<section class="hero">
  <div class="container">
    <div class="reveal on">
      <span class="eyebrow">Affiliate Opportunity</span>
      <h1>
        Earn With <span class="hl2">100% Commissions</span><br>
        <span class="headline-animated">We help Affiliates — Students — Housewives — Newbies</span>
      </h1>

      <div class="kpis">Join Over <b style="color:#ffb454">1,00,000+</b> Working Professionals, Housewives, Students &amp; Self Employed with us</div>

      <div class="video-area">
        <!-- main player -->
        <div>
          <div class="player-wrap player-shadow">
            <div class="player-frame" id="playerFrame">
              <iframe id="mainPlayer" src="https://www.youtube.com/embed/SG5MdFiP1zA?rel=0&modestbranding=1&playsinline=1" title="AdHabits Intro" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>
            </div>
            <div class="player-card">
              <div style="display:flex;align-items:center;justify-content:space-between;gap:12px">
                <div>
                  <div style="font-weight:800;font-size:17px;color:#06101d">Success Stories - Student Testimonials</div>
                  <div style="color:#6b7889;margin-top:6px">Watch how our affiliates & students are earning 100% commissions</div>
                </div>
                <div style="display:flex;gap:10px;align-items:center">
                  <div class="timer" id="countdown">01:00:00</div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- selectors -->
        <aside>
          <div class="video-select">
            <div class="vitem active" data-video="SG5MdFiP1zA">
              <div class="thumb">▶</div>
              <div class="vmeta">
                <h4>Success Stories</h4>
                <p>Real students & affiliates sharing wins.</p>
              </div>
            </div>

            <div class="vitem" data-video="dQw4w9WgXcQ">
              <div class="thumb">▶</div>
              <div class="vmeta">
                <h4>Behind the Scenes</h4>
                <p>Coach journey & how offers are structured.</p>
              </div>
            </div>

            <div class="reasons">
              <strong>Why watch?</strong>
              <ul>
                <li>See actual affiliate results & 100% commission examples</li>
                <li>Understand how homemakers & newbies started earning</li>
                <li>Learn the simple offer that converts</li>
                <li>Get motivated — it’s repeatable</li>
              </ul>
            </div>
          </div>
        </aside>
      </div>

      <div style="margin-top:18px" class="cta">
        <button class="btn primary" id="ctaStart">I want 100% commissions — Get me started</button>
        <a href="#features" class="btn secondary">See What You Learn</a>
      </div>

      <div class="panel">⚡ Fast onboarding • ✅ 1:1 mentoring • 💬 WhatsApp support</div>
    </div>
  </div>
</section>

<section id="features" class="features-section">
  <div class="container">
    <div class="join-head">
      <h2>🌱 Aap Yahan Seekhenge</h2>
      <p>Real, skill-based aur sustainable online income opportunity — phone se kaam, flexible timing.</p>
    </div>

    <div class="features-grid" id="featuresGrid">
      <div class="feature-card pop-anim" data-pop>
        <div class="icon">💡</div>
        <h3>In-demand Digital Skills</h3>
        <p>Latest market skills jo demand mein hain.</p>
      </div>

      <div class="feature-card pop-anim" data-pop>
        <div class="icon">📞</div>
        <h3>Phone Se Kaam</h3>
        <p>Apne phone se professional kaam karna.</p>
      </div>

      <div class="feature-card pop-anim" data-pop>
        <div class="icon">⏰</div>
        <h3>Flexible Timing</h3>
        <p>Apne time ke according kaam karo.</p>
      </div>

      <div class="feature-card pop-anim" data-pop>
        <div class="icon">🆔</div>
        <h3>Online Identity</h3>
        <p>Confidently apni online presence build karna.</p>
      </div>
    </div>
  </div>
</section>

<section class="steps">
  <div class="container">
    <h2 style="text-align:center;font-weight:800;font-size:34px;color:var(--text)">What Happens When You Join?</h2>
    <div style="height:12px"></div>
    <div class="steps-grid" id="stepsGrid">
      <div class="step-card reveal">
        <div class="step-num">1</div>
        <div class="step-body">
          <h4>Instant Connection</h4>
          <p>Message on WhatsApp & instantly connect with coach for guidance.</p>
      </div>
      </div>

      <div class="step-card reveal">
        <div class="step-num">2</div>
        <div class="step-body">
          <h4>Complete Access</h4>
          <p>Unlock step-by-step training, scripts, and creatives for affiliates.</p>
        </div>
      </div>

      <div class="step-card reveal">
        <div class="step-num">3</div>
        <div class="step-body">
          <h4>Daily Mentorship</h4>
          <p>Daily support and scaling help — small or big package sellers both welcome.</p>
        </div>
      </div>

      <div class="step-card reveal">
        <div class="step-num">4</div>
        <div class="step-body">
          <h4>Start Earning</h4>
          <p>Start earning 100% commissions with our offers and guidance.</p>
        </div>
      </div>
    </div>

    <div style="margin-top:26px;text-align:center">
      <button class="btn primary" id="bottomWhats">💬 Message on WhatsApp: +91 9610580359</button>
    </div>
  </div>
</section>

<section id="coach" class="coach-section">
  <div class="coach-inner container">
    <div class="coach-photo reveal">
      <img src="https://i.postimg.cc/vm9tGMTm/Whats-App-Image-2025-09-26-at-11-47-37.jpg" alt="Coach Rahman">
    </div>

    <div class="coach-copy reveal">
      <span class="coach-badge">Your Coach</span>
      <h3 class="coach-head">Hi, Rahman here — I help affiliates scale & earn <span style="color:#ffcf8a">100% commissions</span></h3>
      <p class="coach-desc">I work with students, homemakers and full-time affiliates. If you're stuck, I help you grow from first sale to consistent income — small & big packages both supported. I provide ad traffic, scripts, 1:1 audits & weekly payouts.</p>

      <div class="coach-stats" aria-hidden="false">
        <div class="stat-pill">
          <div class="stat-num knum" data-count="3">0</div>
          <div class="stat-label">Years Experience</div>
        </div>

        <div class="stat-pill">
          <div class="stat-num knum" data-count="250">0</div>
          <div class="stat-label">Affiliates Helped</div>
        </div>

        <div class="stat-pill">
          <div class="stat-num knum" data-count="100000">0</div>
          <div class="stat-label">Leads Delivered</div>
        </div>
      </div>

      <div class="coach-cta">
        <button class="btn-chat" id="coachChatBtn">💬 Talk with Rahman on WhatsApp</button>
        <button id="coachWhats" class="btn secondary" style="background:transparent;border:1px solid rgba(255,255,255,0.06);color:var(--text);padding:12px 16px;border-radius:12px;">Get 1:1 — Start Chat</button>
        <button class="btn secondary" id="coachLearnBtn" style="background:transparent;border:1px solid rgba(255,255,255,0.06);color:var(--text);padding:12px 16px;border-radius:12px;">View Affiliate Plans</button>
      </div>
    </div>
  </div>
</section>

<section id="testimonials" style="padding:36px 0">
  <div class="container">
    <h2 style="font-weight:800">Client Testimonials</h2>
    <p style="color:#9fb0c9;margin-top:8px">Real WhatsApp screenshots from happy affiliates & students</p>

    <div style="display:flex;gap:12px;overflow:auto;padding-top:12px;margin-top:12px">
      <img src="https://i.postimg.cc/PJtN2tcP/nasreen-mam-finel.jpg" style="width:200px;border-radius:12px" alt="">
      <img src="https://i.postimg.cc/G3qpbnVx/Rukkaya-appi-finel.jpg" style="width:200px;border-radius:12px" alt="">
      <img src="https://i.postimg.cc/LXSzFFwM/Farheen-mam.jpg" style="width:200px;border-radius:12px" alt="">
      <img src="https://i.postimg.cc/vBDGBcp7/Firdous-finel.jpg" style="width:200px;border-radius:12px" alt="">
    </div>
  </div>
</section>

<section id="getstart">
  <div class="container form-wrap">
    <div class="form-card">
      <h3>Get Started — Become an Affiliate</h3>
      <p class="form-note">Hello Rahman sir, I want to become an affiliate and start earning. My details below 👇</p>

      <label for="platform">Which Offer</label>
      <select id="platform">
        <option>Affiliate — 100% Commission Offer</option>
        <option>Starter Affiliate (low-ticket)</option>
        <option>Growth Affiliate (mid-ticket)</option>
        <option>High-ticket Affiliate</option>
      </select>

      <label for="name">Your Name</label>
      <input id="name" type="text" placeholder="Your name" required>

      <label for="phone">Phone Number</label>
      <input id="phone" type="tel" placeholder="10-digit number" required>

      <label for="profession">Profession</label>
      <select id="profession">
        <option value="Student">Student</option>
        <option value="Job Person">Job Person</option>
        <option value="Housewife">Housewife</option>
        <option value="Business Person">Business Person</option>
        <option value="Other">Other</option>
      </select>

      <div style="margin-top:10px">
        <button id="sendBtn" class="form-btn">Send on WhatsApp</button>
        <span class="form-hint">Auto-opens WhatsApp after saving.</span>
      </div>
    </div>

    <aside class="right-box reveal">
      <h3>Ready to Earn Daily?</h3>
      <p style="color:#9fb0c9">Click and message us to get affiliate onboarding and creatives.</p>

      <div style="margin-top:12px" class="stat-grid" aria-hidden="true">
        <div class="stat" style="display:inline-block;margin-right:12px">
          <div class="num knum" data-count="3">0</div>
          <div class="lbl" style="color:#9fb0c9">Years</div>
        </div>
        <div class="stat" style="display:inline-block;margin-right:12px">
          <div class="num knum" data-count="250">0</div>
          <div class="lbl" style="color:#9fb0c9">Affiliates</div>
        </div>
        <div class="stat" style="display:inline-block">
          <div class="num knum" data-count="50">0</div>
          <div class="lbl" style="color:#9fb0c9">₹50 L+ Budget</div>
        </div>
      </div>
    </aside>
  </div>
</section>

<footer>
  <div class="foot" style="max-width:1150px;margin:auto;padding:16px 18px 26px;color:#aeb8cc">
    <div style="display:flex;align-items:center;justify-content:space-between;gap:14px;flex-wrap:wrap">
      <small>© 2025 AdHabits. All rights reserved.</small>
      <div><a class="terms" href="#terms">Terms</a></div>
    </div>
    <div id="terms" style="margin-top:8px;color:#9fb0c9">
      <b>Terms &amp; Conditions:</b> Services are provided as-is. All payments are <u>Non-Refundable</u>.
    </div>
  </div>
</footer>

<script>
/* Mobile menu toggle */
const hamb = document.getElementById('hamb'), mnav = document.getElementById('mnav');
if(hamb) hamb.onclick = () => { mnav.style.display = (mnav.style.display === 'block') ? 'none' : 'block'; };

/* reveal & counters */
function revealInit(){
  document.querySelectorAll('.reveal, .pop-anim').forEach(el=>el.classList.add('reveal')); // ensure class exists
  const revealEls = document.querySelectorAll('.reveal');
  const obs = new IntersectionObserver((entries, o)=>{
    entries.forEach(en=>{
      if(en.isIntersecting){
        en.target.classList.add('on');
        o.unobserve(en.target);
      }
    });
  }, {threshold: 0.18});
  revealEls.forEach(el=>obs.observe(el));
}
revealInit();

function animateNum(el, to, dur=1200){
  const start = performance.now(), from = 0;
  function step(now){
    const p = Math.min(1,(now-start)/dur);
    const ease = 1 - Math.pow(1-p,3);
    el.textContent = Math.floor(from + ease*to).toLocaleString('en-IN');
    if(p < 1) requestAnimationFrame(step);
  }
  requestAnimationFrame(step);
}
document.querySelectorAll('.knum, .num').forEach(k => {
  k.textContent = '0';
  const target = parseInt(k.dataset.count || '0', 10) || 0;
  const ioNum = new IntersectionObserver((entries, ob) => {
    entries.forEach(e => {
      if(e.isIntersecting){
        animateNum(k, target, 1300);
        ob.unobserve(e.target);
      }
    });
  }, {threshold: 0.4});
  ioNum.observe(k);
});

/* video selector */
const videoItems = document.querySelectorAll('.vitem');
const mainPlayer = document.getElementById('mainPlayer');
videoItems.forEach(item=>{
  item.addEventListener('click', ()=>{
    videoItems.forEach(i=>i.classList.remove('active'));
    item.classList.add('active');
    const vid = item.dataset.video;
    if(mainPlayer) mainPlayer.src = `https://www.youtube.com/embed/${vid}?rel=0&modestbranding=1&playsinline=1&autoplay=1`;
    if(window.innerWidth < 900) document.getElementById('playerFrame')?.scrollIntoView({behavior:'smooth', block:'center'});
  });
});

/* ---------- FEATURES stacking: activate only when section enters view ---------- 
   Behavior:
   - Initially cards are normal (no overlap).
   - When #features intersects (threshold), JS adds sticky + negative margin to create stacking.
   - When #features is NOT intersecting (scrolled away above), JS removes sticky so normal flow restored.
*/
const featuresSection = document.getElementById('features');
const featureCards = Array.from(document.querySelectorAll('.features-grid .feature-card'));

const stackingConfig = {
  baseTop: 90,        // px — where first card will stick (so it's fully visible)
  step: 44,           // px — how much higher subsequent cards stick (overlap amount)
  marginBottomNeg: -64 // px — negative margin to pull cards for overlap
};

function applyStackingActive(){
  // apply sticky stacking (mobile only)
  const isMobile = window.matchMedia('(max-width:640px)').matches;
  if(!isMobile) return;
  const grid = document.querySelector('.features-grid');
  if(grid) grid.style.paddingBottom = (Math.abs(stackingConfig.marginBottomNeg) + 180) + 'px';
  featureCards.forEach((c, idx) => {
    c.style.position = 'sticky';
    let topVal = stackingConfig.baseTop - (idx * stackingConfig.step);
    if(topVal < 8) topVal = 8;
    c.style.top = topVal + 'px';
    c.style.zIndex = 200 + idx;
    c.style.marginBottom = stackingConfig.marginBottomNeg + 'px';
    c.style.overflow = 'visible';
    c.style.willChange = 'transform';
  });
}

function removeStackingActive(){
  // revert to normal flow
  const grid = document.querySelector('.features-grid');
  if(grid) grid.style.paddingBottom = '';
  featureCards.forEach((c)=>{
    c.style.position = '';
    c.style.top = '';
    c.style.zIndex = '';
    c.style.marginBottom = '';
    c.style.overflow = '';
    c.style.willChange = '';
  });
}

/* IntersectionObserver to toggle stacking only when #features is near viewport
   threshold and rootMargin tuned so stacking triggers just when section is reached.
*/
if(featuresSection && featureCards.length){
  const obs = new IntersectionObserver((entries)=>{
    entries.forEach(en=>{
      if(en.isIntersecting){
        // activate stacking shortly after intersection to ensure layout stable
        applyStackingActive();
      } else {
        // if section is above (not intersecting) remove stacking so layout goes back to normal
        removeStackingActive();
      }
    });
  }, {threshold: 0.15, rootMargin: '0px 0px -20% 0px'});
  obs.observe(featuresSection);

  // also reapply on resize/orientation because mobile state may change
  window.addEventListener('resize', ()=> {
    // if currently intersecting (in view), keep stacking according to current viewport
    // quick check: if section top within viewport height*0.9 then apply
    const rect = featuresSection.getBoundingClientRect();
    const inView = rect.top < window.innerHeight*0.85 && rect.bottom > 0;
    if(inView) applyStackingActive();
    else removeStackingActive();
  });
}

/* small pop animation for features */
featureCards.forEach(card=>{
  card.addEventListener('click', ()=> {
    card.classList.add('pop');
    setTimeout(()=>card.classList.remove('pop'), 700);
  });
  card.addEventListener('touchstart', ()=> card.classList.add('pop'));
  card.addEventListener('touchend', ()=> setTimeout(()=>card.classList.remove('pop'), 600));
});

/* countdown (1 hour persisted) */
(function(){
  const cdElem = document.getElementById('countdown');
  if(!cdElem) return;
  const key = 'adh_countdown_end';
  let end = sessionStorage.getItem(key);
  if(!end || isNaN(+end)){
    end = Date.now() + (60*60*1000);
    sessionStorage.setItem(key, end);
  } else end = +end;
  function tick(){
    const now = Date.now();
    const diff = Math.max(0, end - now);
    const hrs = Math.floor(diff / (1000*60*60));
    const mins = Math.floor((diff % (1000*60*60)) / (1000*60));
    const secs = Math.floor((diff % (1000*60)) / 1000);
    cdElem.textContent = `${String(hrs).padStart(2,'0')}:${String(mins).padStart(2,'0')}:${String(secs).padStart(2,'0')}`;
    if(diff>0) requestAnimationFrame(tick); else cdElem.textContent = '00:00:00';
  }
  tick();
})();

/* form + whatsapp (profession included) */
const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbznR1Wk3Gn2jztC1ZXnBW4jr52146ctHC3phfdn8Ve3zuwKvCflNIOy_sxfPZNhQbbf/exec";
const WHATSAPP_TO = "919610580359";

function saveLeadFast(params){
  try{
    const utm = sessionStorage.getItem('adh_utm');
    if(utm) params.append('utm', utm);
    if(navigator.sendBeacon){
      const blob = new Blob([params.toString()], {type:'application/x-www-form-urlencoded'});
      navigator.sendBeacon(SCRIPT_URL, blob);
    }else{
      fetch(SCRIPT_URL, { method:'POST', body: params, mode:'no-cors', keepalive:true }).catch(()=>{});
    }
  }catch(_){}
}
function track(e,d){ try{ fbq && fbq('track', e, d||{}); }catch(_){ } }
function trackCustom(n,d){ try{ fbq && fbq('trackCustom', n, d||{}); }catch(_){ } }

function openWhatsApp({name, phone, platform, plan, profession}){
  trackCustom('WhatsAppOpen', {plan, platform});
  const msg = `Hello Rahman sir, I want to become an affiliate and start earning.\nThis is my detail:\nName: ${name}\nPhone: ${phone}\nProfession: ${profession || 'Not specified'}\nOffer: ${platform}\nPlan: ${plan || 'Affiliate Onboard'}\n\nPlease guide me.`;
  window.open(`https://wa.me/${WHATSAPP_TO}?text=${encodeURIComponent(msg)}`, '_blank');
}

const sendBtn = document.getElementById('sendBtn');
if(sendBtn){
  sendBtn.addEventListener('click', (e)=>{
    e.preventDefault();
    const platform = document.getElementById('platform').value.trim();
    const name = document.getElementById('name').value.trim();
    const phone = document.getElementById('phone').value.trim();
    const profession = document.getElementById('profession').value.trim();
    const plan = sessionStorage.getItem('adh_plan') || 'Affiliate Starter';
    if(!name || !phone){ alert('Please enter your Name and Phone.'); return; }
    if(!/^\d{10}$/.test(phone)){ alert('Enter 10-digit phone number.'); return; }
    const old = sendBtn.textContent; sendBtn.disabled = true; sendBtn.textContent = 'Opening WhatsApp...';
    const payload = new URLSearchParams({ name, phone, platform, plan, profession });
    saveLeadFast(payload);
    track('Lead', { content_name: plan, content_category: platform });
    openWhatsApp({name, phone, platform, plan, profession});
    setTimeout(()=>{ sendBtn.disabled=false; sendBtn.textContent = old; }, 1200);
  });
}

/* quick CTAs */
document.getElementById('ctaStart')?.addEventListener('click', ()=>{
  sessionStorage.setItem('adh_plan', 'Affiliate Onboard');
  document.getElementById('name')?.focus({preventScroll:true});
  location.hash = '#getstart';
});
document.getElementById('bottomWhats')?.addEventListener('click', ()=>{
  sessionStorage.setItem('adh_plan', 'Affiliate Onboard');
  document.getElementById('name')?.focus({preventScroll:true});
  location.hash = '#getstart';
});
document.getElementById('coachWhats')?.addEventListener('click', ()=>{
  sessionStorage.setItem('adh_plan', 'Coach 1:1');
  document.getElementById('name')?.focus({preventScroll:true});
  location.hash = '#getstart';
});
document.getElementById('coachChatBtn')?.addEventListener('click', ()=>{
  try{ if(window.fbq) fbq('trackCustom','WhatsAppCoachClick'); }catch(e){}
  const msg = `Hello Rahman sir, I want to join as an affiliate.\nName:\nPhone:\nInterested in: Affiliate onboarding / 100% commission offers`;
  window.open(`https://wa.me/${WHATSAPP_TO}?text=${encodeURIComponent(msg)}`, '_blank');
});
document.getElementById('coachLearnBtn')?.addEventListener('click', ()=>{
  const t = document.getElementById('plans') || document.getElementById('getstart');
  if(t) t.scrollIntoView({behavior:'smooth', block:'start'});
});

/* ensure initial layout fine and stacking toggles after load */
window.addEventListener('load', ()=> {
  // remove any stacking (safety)
  removeStackingActive && removeStackingActive();
  // small timeout so fonts/layout settle
  setTimeout(()=> {
    // if user already scrolled into features on load, apply stacking
    const rect = featuresSection?.getBoundingClientRect();
    if(rect && rect.top < window.innerHeight*0.85 && rect.bottom > 0){
      applyStackingActive();
    }
  }, 150);
});
</script>

</body>
</html>
